# EAC-multiome

This repository accompanies the work "[TBD]" (ref)
It contains all the code necessary to reproduce the analyses. 
Each subsection contains a README that contains a description of the path placeholders. 

## How to reproduce the analyses

To reproduce the analyses, one first needs to download the data available at XXX ([Instructions](link))

Then, one needs to run the scripts in order, as some intermediate files generated by the scripts will be re-used in subsequent scripts. 

For the snRNA-seq analysis, one needs to 
- run the preprocessing for each patient ([Instructions](link))
- run the preprocessing scripts for the external dataset to put them in the right format ([Instructions](link))
- run the analyses ([Instructions](link))
- run the pyscenic plus scripts ([Instructions](link))
- run the pyscenic scripts on external datasets ([Instructions](link))
- run the scripts for external validation ([Instructions](link))

For the snATAC-seq analysis, one needs to 
- run the prepocessing scripts ([Instructions](link))
- run BayesPrism for TCGA validation ([Instructions](link))

## Links to data used in the study

| Dataset             | Link to paper                  | Link to download                 | Remarks          | 
|---------------------|--------------------------------|---------------------------------|------------------|
| Discovery dataset    | [Yates et al., ???](TBD)    | [Download](http://example.com)  |     |
| Single-cell, Carroll et al.     | [Carroll et al., 2023](https://www.sciencedirect.com/science/article/pii/S1535610823002167?via%3Dihub)    | [Download](https://ega-archive.org/datasets/EGAD00001009401)  | Need to request access to data through EGA     |
| Bulk, Carroll et al., RNA   | [Carroll et al., 2023](https://www.sciencedirect.com/science/article/pii/S1535610823002167?via%3Dihub)    | [Download](https://ega-archive.org/datasets/EGAD00001009399)  | Need to request access to data through EGA  |
| Bulk, Carroll et al., Clinical   | [Carroll et al., 2023](https://www.sciencedirect.com/science/article/pii/S1535610823002167?via%3Dihub)     | [Download](https://bitbucket.org/licroxford/carroll_etal_2023/src/master/supplementary_files/Table_S8_papermetadata.xlsx)  | Inoperable cohort info is located [here](https://bitbucket.org/licroxford/carroll_etal_2023/src/master/supplementary_files/SuppInfo_OperablePts_LUD2015scRNAseq.xlsx)   |
| Single-cell, Croft et al.     | [Croft et al., 2022](https://molecular-cancer.biomedcentral.com/articles/10.1186/s12943-022-01666-x)    | [Download](https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE222078)  | Need to request single-cell annotations from author (w.d.croft@bham.ac.uk)    |
| Bulk, Hoefnagel et al., RNA     | [Hoefnagel et al., 2022](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC9496882/)    | [Download](https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE207527)  |     |
| Bulk, Hoefnagel et al., Clinical     | [Hoefnagel et al., 2022](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC9496882/)    | NA | Need to request from the author (sanne_hoefnagel@live.nl) |
| Bulk, TCGA, RNA (FPKM)| [The Cancer Genome Atlas Research Network, 2017](https://www.nature.com/articles/nature20805)    | [Download](https://xenabrowser.net/datapages/?dataset=TCGA-ESCA.htseq_fpkm-uq.tsv&host=https%3A%2F%2Fgdc.xenahubs.net&removeHub=https%3A%2F%2Fxena.treehouse.gi.ucsc.edu%3A443)  |  Used in the general TCGA analysis script  |
| Bulk, TCGA, RNA (Raw counts)| [The Cancer Genome Atlas Research Network, 2017](https://www.nature.com/articles/nature20805)    | [Download](https://xenabrowser.net/datapages/?dataset=TCGA-ESCA.htseq_counts.tsv&host=https%3A%2F%2Fgdc.xenahubs.net&removeHub=https%3A%2F%2Fxena.treehouse.gi.ucsc.edu%3A443)  |  Used as a basis to deconvolve for BayesPrism  |
| Bulk, TCGA, Clinical #1     | [The Cancer Genome Atlas Research Network, 2017](https://www.nature.com/articles/nature20805)    | [Download](https://xenabrowser.net/datapages/?dataset=TCGA-ESCA.GDC_phenotype.tsv&host=https%3A%2F%2Fgdc.xenahubs.net&removeHub=https%3A%2F%2Fxena.treehouse.gi.ucsc.edu%3A443)  | This is the general clinical+phenotypical info   |
| Bulk, TCGA, Clinical #2     | [The Cancer Genome Atlas Research Network, 2017](https://www.nature.com/articles/nature20805)  | [Download](https://static-content.springer.com/esm/art%3A10.1038%2Fnature20805/MediaObjects/41586_2017_BFnature20805_MOESM91_ESM.xlsx?_gl=1*mw3dke*_ga*OTAwNDk3MDU2LjE3MDg2ODk0Mzk.*_ga_B3E4QL2TPR*MTcxMDc3MDI1My4yMS4wLjE3MTA3NzAzNTcuMC4wLjA.)  | This is the clinical info provided in the original paper    |
| Bulk, TCGA, Clinical #3     | [The Cancer Genome Atlas Research Network, 2017](https://www.nature.com/articles/nature20805)  | [Download](https://xenabrowser.net/datapages/?dataset=TCGA-ESCA.survival.tsv&host=https%3A%2F%2Fgdc.xenahubs.net&removeHub=https%3A%2F%2Fxena.treehouse.gi.ucsc.edu%3A443)  | This is the survival information|

## Links to author data to download
| Data             | Needed for what script?                  | Description               | Link to download          | 
|---------------------|--------------------------------|---------------------------------|------------------|
| Gene Mapping    | R/scripts/BayesPrism/runBPrism.R    | Gene probe map fro the UCSC Xena browser that maps ENCODE to official gene ID |   [Download](https://github.com/ucscXena/xena-GDC-ETL/blob/master/xena_gdc_etl/resources/gencode.v22.annotation.gene.probeMap)  |
| Gene Mapping    | R/scripts/BayesPrism/runBPrism.R    | Gene probe map fro the UCSC Xena browser that maps ENCODE to official gene ID |   [Download](https://github.com/ucscXena/xena-GDC-ETL/blob/master/xena_gdc_etl/resources/gencode.v22.annotation.gene.probeMap)  |
